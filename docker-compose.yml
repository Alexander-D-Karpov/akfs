services:
  vtfs-server:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: vtfs-server
    ports:
      - "9000:9000"
    volumes:
      - vtfs-data:/var/lib/vtfs
    environment:
      - VTFS_LISTEN=0.0.0.0:9000
      - VTFS_STORAGE=/var/lib/vtfs/data.bin
      - VTFS_WAL=/var/lib/vtfs/data.wal
      - VTFS_MAX_SIZE=2147483648
      - VTFS_TOKEN=admin
      - VTFS_KEY=default-encryption-key-32bytes!
      - LOG_LEVEL=info
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "9000"]
      interval: 10s
      timeout: 5s
      retries: 3

volumes:
  vtfs-data:
